(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{187:function(e,t,s){"use strict";s.r(t);var r=s(0),n=Object(r.a)({},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"路由-koa-router"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#路由-koa-router","aria-hidden":"true"}},[e._v("#")]),e._v(" 路由 koa-router")]),e._v(" "),s("blockquote",[s("p",[e._v("安装")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("npm install koa-router\n")])])]),s("blockquote",[s("p",[e._v("使用example")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("const Koa = require('koa')\n// 注意 require('koa-router') 返回的是函数:\nconst router = require('koa-router')()\nconst app = new Koa()\n\n // 添加路由\n router.get('/', async (ctx, next) => {\n    ctx.response.body = '<h1>index page</h1>'\n})\n\nrouter.get('/home', async (ctx, next) => {\n    ctx.response.body = '<h1>HOME page</h1>'\n})\n\nrouter.get('/404', async (ctx, next) => {\n    ctx.response.body = '<h1>404 Not Found</h1>'\n})\n\n // 调用路由中间件\n app.use(router.routes())\n\napp.listen(3000, ()=>{\n  console.log('server is running at http://localhost:3000')\n})\n\n")])])]),s("blockquote",[s("p",[e._v("路由方法")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("get | post | put | delete | del | all\n\n*all代表匹配所有，一般放在中间件的末尾\n")])])]),s("blockquote",[s("p",[e._v("重定向")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("router.redirect('/login', 'sign-in');\n")])])]),s("blockquote",[s("p",[e._v("动态路由")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("router.get('/users/:id', (ctx, next) => {\n // ...\n});\n")])])]),s("p",[e._v("类似于vue-router，可以将参数直接以 /path/parma 的形式传递参数")]),e._v(" "),s("p",[e._v("路由参数被捕获并添加到ctx.params")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("router.get('/:category/:title', (ctx, next) => {\n  console.log(ctx.params);\n  // => { category: 'programming', title: 'how-to-node' }\n});\n")])])]),s("blockquote",[s("p",[e._v("命名路由")])]),e._v(" "),s("p",[e._v("给路由命名，可以在开发过程中生成URl并重新命名URL")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("router.get('user', '/users/:id', (ctx, next) => {\n  // ...\n});\n\nrouter.url('user', 3);\n// => \"/users/3\"\n\nrouter.url('user', { id: 3 });\n// => \"/users/3\"\n\nrouter.use((ctx, next) => {\n  // redirect to named route\n  ctx.redirect(ctx.router.url('sign-in'));\n})\n\nrouter.url('user', { id: 3 }, { query: { limit: 1 } });\n// => \"/users/3?limit=1\"\n\nrouter.url('user', { id: 3 }, { query: \"limit=1\" });\n// => \"/users/3?limit=1\"\n")])])]),s("blockquote",[s("p",[e._v("多个中间件")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("router.get(\n  '/users/:id',\n  (ctx, next) => {\n    return User.findOne(ctx.params.id).then(function(user) {\n      ctx.user = user;\n      next();\n    });\n  },\n  ctx => {\n    console.log(ctx.user);\n    // => { id: 17, name: \"Alex\" }\n  }\n);\n")])])]),s("blockquote",[s("p",[e._v("路由嵌套")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("var forums = new Router();\nvar posts = new Router();\n\nposts.get('/', (ctx, next) => {...});\nposts.get('/:pid', (ctx, next) => {...});\nforums.use('/forums/:fid/posts', posts.routes(), posts.allowedMethods());\n\n// responds to \"/forums/123/posts\" and \"/forums/123/posts/123\"\napp.use(forums.routes());\n")])])]),s("blockquote",[s("p",[e._v("路由前缀")])]),e._v(" "),s("p",[e._v("类似于vue-router的子路由")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("var router = new Router({\n  prefix: '/users'\n});\n\nrouter.get('/', ...); // responds to \"/users\"\nrouter.get('/:id', ...); // responds to \"/users/:id\"\n")])])])])},[],!1,null,null,null);t.default=n.exports}}]);