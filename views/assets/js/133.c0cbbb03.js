(window.webpackJsonp=window.webpackJsonp||[]).push([[133],{201:function(s,n,e){"use strict";e.r(n);var a=e(0),t=Object(a.a)({},function(){var s=this,n=s.$createElement,e=s._self._c||n;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"promiseã€"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#promiseã€","aria-hidden":"true"}},[s._v("#")]),s._v(" Promiseã€")]),s._v(" "),e("blockquote",[e("p",[s._v("å®ç°æ­¥éª¤")])]),s._v(" "),e("ul",[e("li",[s._v("å®ç°ç®€å•çš„åŒæ­¥Promise")]),s._v(" "),e("li",[s._v("å¢åŠ å¼‚æ­¥åŠŸèƒ½")]),s._v(" "),e("li",[s._v("å¢åŠ é“¾å¼è°ƒç”¨then")]),s._v(" "),e("li",[s._v("å¢åŠ catch finallyæ–¹æ³•")]),s._v(" "),e("li",[s._v("å¢åŠ all race ç­‰æ–¹æ³•")]),s._v(" "),e("li",[s._v("å®ç°ä¸€ä¸ªpromiseçš„å»¶è¿Ÿå¯¹è±¡defer")]),s._v(" "),e("li",[s._v("æœ€ç»ˆæµ‹è¯•")])]),s._v(" "),e("h2",{attrs:{id:"å®ç°ç®€å•çš„åŒæ­¥promise"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#å®ç°ç®€å•çš„åŒæ­¥promise","aria-hidden":"true"}},[s._v("#")]),s._v(" å®ç°ç®€å•çš„åŒæ­¥Promise")]),s._v(" "),e("p",[s._v("é¦–å…ˆè¦çŸ¥é“ï¼š")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("Promiseå†…éƒ¨ç»´æŠ¤ç€ä¸‰ç§çŠ¶æ€ï¼špendingï¼ˆè¿›è¡Œä¸­ï¼‰ã€resolvedï¼ˆä»»åŠ¡æ‰§è¡ŒæˆåŠŸï¼‰ã€rejectï¼ˆä»»åŠ¡å¤±è´¥ç»“æœï¼‰ï¼Œâš ï¸åˆ‡è®°ï¼šä¸‰ç§çŠ¶æ€ï¼Œåªè¦æ”¹å˜å°±ä¸èƒ½å†è¢«æ”¹æˆå…¶ä»–çŠ¶æ€ï¼›å³pending->resolveåæ˜¯ä¸èƒ½å†è½¬å˜æˆåˆ«çš„çŠ¶æ€ã€‚")])]),s._v(" "),e("li",[e("p",[s._v("Promise å†…éƒ¨æœ‰ä¸€ä¸ªvalue å±æ€§ï¼Œvalueå€¼å³ä»»åŠ¡æ‰§è¡ŒæˆåŠŸè¿”å›çš„ç»“æœï¼›âš ï¸å¦‚æœåœ¨valueå¯ä»¥æ˜¯ä»»ä½•å€¼ä½†æ˜¯å¦‚æœæƒ³è¦æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡æ˜¯å¿…é¡»è¿”å›ä¸€ä¸ªpromiseå¯¹è±¡ï¼Œå½“ç„¶è¿™ä¸ªè¯´çš„æ˜¯åœ¨thenå‡½æ•°ä¸­äº†ï¼Œ")])]),s._v(" "),e("li",[e("p",[s._v("Promise å†…éƒ¨æœ‰ä¸€ä¸ª reason å±æ€§ï¼Œç”¨æ¥å­˜æ”¾ Promise çŠ¶æ€å˜ä¸º rejected çš„åŸå› ")])])]),s._v(" "),e("p",[s._v("æ¥ä¸‹æ¥è®©æˆ‘å®ç°ä¸€ä¸‹åŒæ­¥çš„Promiseå‡½æ•°\næ³¨æ„1.2.3.4.5")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("function Promise(executor) {\n    let _this = this;\n    /** 2 å®šä¹‰åˆå§‹çš„ä¸€äº›å˜é‡ */\n    this.value = null;\n    this.status = 'pending';\n    this.reason = null\n\n    /** 3 å®šä¹‰åˆå§‹çš„æˆåŠŸå’Œå¤±è´¥å‡½æ•° */\n    function resolve(value) {\n        /** 4 åˆ¤æ–­çŠ¶æ€æ˜¯ä¸æ˜¯åˆå§‹çŠ¶æ€pending \n         *    æ˜¯å°±è½¬æ¢çŠ¶æ€ å¦åˆ™ä¸è½¬æ¢ \n         *    ç¡®ä¿çŠ¶æ€çš„å˜åŒ–åçš„ä¸å¯å˜æ€§ */\n        if (_this.status == 'pending') {\n            this.status = 'resloved';\n            this.value = value\n        }\n    }\n\n    function reject(reason) {\n        /** 5 åŒä¸Š */\n        if (_this.status === 'pending') {\n            that.status = 'rejected';\n            that.reason = reason;\n        }\n    }\n    /**\n     * 1 Promiseä¸­é¦–å…ˆä¼ äº†ä¸€ä¸ªexecutorï¼Œå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°\n     *   executorå‡½æ•°ä¸­åˆä¼ äº†ä¸¤ä¸ªå‡½æ•°ï¼Œåˆ†åˆ«æ˜¯resolveå’Œreject\n     *   å¾ˆæ˜¾ç„¶ resolveæ˜¯æˆåŠŸå›è°ƒï¼Œrejectæ˜¯å¤±è´¥çš„å›è°ƒ\n     */\n    executor(resolve, reject);\n}\n/**å®šä¹‰promiseçš„thenæ–¹æ³•\n    thenæ–¹æ³•ä¸Šé¢æœ‰ä¸¤ä¸ªå›è°ƒ ä¸€ä¸ªæ˜¯æˆåŠŸåçš„æ–¹æ³• å¦ä¸€ä¸ªæ˜¯å¤±è´¥åçš„æ–¹æ³•\n *    æ ¹æ®æˆåŠŸæˆ–å¤±è´¥çš„çŠ¶æ€å»æ‰§è¡Œç›¸å…³æˆåŠŸonFilfulled()æˆ–è€…å¤±è´¥onRejected()çš„å›è°ƒæ–¹æ³•*/\nPromise.prototype.then = function (onFilfulled, onRejected) {\n    let _this = this;\n    /** 7 å¦‚æœçŠ¶æ€å·²ç»å˜æ›´ä¸ºresolved \n     *    è¯´æ˜resolveæ–¹æ³•å·²ç»è¢«è°ƒç”¨\n     *    é‚£ä¹ˆæ­¤æ—¶å°±æ‰§è¡ŒæˆåŠŸçš„å›è°ƒå‡½æ•°onFilfulled\n     *    å¹¶ä¼ å…¥å‚æ•° that.value\n     * */\n    console.log(_this.status)\n    if (_this.status === 'resloved') {\n        onFilfulled(_this.value)\n    }\n    /** 8 å¦‚æœçŠ¶æ€å·²ç»å˜æ›´ä¸ºreject\n     *    è¯´æ˜resolveæ–¹æ³•å·²ç»è¢«è°ƒç”¨\n     *    é‚£ä¹ˆæ­¤æ—¶å°±æ‰§è¡ŒæˆåŠŸçš„å›è°ƒå‡½æ•°onRejected\n     *    å¹¶ä¼ å…¥å‚æ•° that.reason\n     * */\n    if (_this.status === 'rejected') {\n        onRejected(_this.reason)\n    }\n}\n\n// module.exports = Promise;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br")])]),e("h2",{attrs:{id:"å¢åŠ å¼‚æ­¥åŠŸèƒ½"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#å¢åŠ å¼‚æ­¥åŠŸèƒ½","aria-hidden":"true"}},[s._v("#")]),s._v(" å¢åŠ å¼‚æ­¥åŠŸèƒ½")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("function Promise(executor) {\n    let _this = this;\n    this.value = null;\n    this.status = 'pending';\n    this.reason = null;\n     /** 1 å› ä¸ºå¼‚æ­¥ä¸æ˜¯ç«‹å³æ‰§è¡Œ çŠ¶æ€ä¸ä¼šå˜æ›´ æˆåŠŸæˆ–å¤±è´¥çš„å›è°ƒå‡½æ•°ä¹Ÿä¸ä¼šæ‰§è¡Œ\n     *    æ‰€ä»¥å…ˆå®šä¹‰å¥½å­˜æ”¾æˆåŠŸæˆ–å¤±è´¥å›è°ƒå‡½æ•°çš„æ•°ç»„ \n     *    ä»¥ä¾¿å°†æˆåŠŸæˆ–å¤±è´¥çš„å›è°ƒå‡½æ•°å…ˆä¿å­˜èµ·æ¥\n     * */\n    this.onFilFulledCallbacks = [];\n    this.onRejectedCallbacks = [];\n\n    function resolve(value) {\n        if (_this.status == 'pending') {\n            this.status = 'resloved';\n            this.value = value;\n            /** 3 æˆåŠŸå‘å¸ƒ\n             *    ç­‰å¾…çŠ¶æ€å‘ç”Ÿå˜æ›´\n             *    çŠ¶æ€å˜æ›´å ç«‹å³æ‰§è¡Œä¹‹å‰å­˜æ”¾åœ¨ç›¸åº”æ•°ç»„ä¸­æ‰€æœ‰çš„æˆåŠŸçš„å›è°ƒå‡½æ•°\n             *    å³ å‘å¸ƒ\n             */\n             this.onFilFulledCallbacks.foEach(fn=>{\n                 fn();\n             })\n        }\n    }\n\n    function reject(reason) {\n        if (_this.status === 'pending') {\n            that.status = 'rejected';\n            that.reason = reason;\n            /** 4å¤±è´¥ å‘å¸ƒ\n             *    ç­‰å¾…çŠ¶æ€å‘ç”Ÿå˜æ›´\n             *    çŠ¶æ€å˜æ›´å ç«‹å³æ‰§è¡Œä¹‹å‰å­˜æ”¾åœ¨ç›¸åº”æ•°ç»„ä¸­æ‰€æœ‰çš„å¤±è´¥çš„å›è°ƒå‡½æ•°\n             *    å³ å‘å¸ƒ\n             */\n             this.onFilFulledCallbacks.foEach(fn=>{\n                 fn();\n             })\n        }\n    }\n    executor(resolve, reject);\n}\nPromise.prototype.then = function (onFilfulled, onRejected) {\n    let _this = this;\n    if (_this.status === 'resloved') {\n        onFilfulled(_this.value)\n    }\n    if (_this.status === 'rejected') {\n        onRejected(_this.reason)\n    }\n    /** 2 è®¢é˜…\n     *    å› ä¸ºæ˜¯å¼‚æ­¥ çŠ¶æ€å½“æ—¶å¹¶æ²¡æœ‰ç«‹å³å˜æ›´ æ‰€ä»¥çŠ¶æ€è¿˜æ˜¯pending\n     *    æ­¤æ—¶éœ€è¦æŠŠæˆåŠŸæˆ–è€…å¤±è´¥çš„å›è°ƒå‡½æ•°å­˜æ”¾åˆ°å¯¹åº”çš„æ•°ç»„ä¸­\n     *    ç­‰å¾…çŠ¶æ€å˜æ›´æ—¶ å†ä»æ•°ç»„ä¸­æ‹¿å‡ºæ¥å»æ‰§è¡Œ\n     *    å³ è®¢é˜…\n     *    *å­˜æ”¾æ•°ç»„æ—¶ ä¸ºäº†æ‰§è¡Œæ—¶æ–¹ä¾¿ éœ€è¦æŠŠå›è°ƒå‡½æ•°çš„å¤–å±‚åŒ…è£¹ä¸€å±‚ç©ºå‡½æ•°\n     */\n    if(_this.status === 'pending'){\n        _this.onFilFulledCallbacks.push(function(){\n            onFilfulled(_this.value);\n        });\n    }\n    if(_this.status === 'pending'){\n        _this.onRejectedCallbacks.push(function(){\n            onRejected(_this.reason);\n        });\n    }\n}\n\nmodule.exports = Promise;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br")])]),e("p",[s._v("è‡³æ­¤ï¼Œæˆ‘ä»¬å®ç°äº†å¼‚æ­¥çš„Promise.å…¶å®è¿™é‡Œçš„å®ç°å¼‚æ­¥çš„æ€æƒ³å°±æ˜¯å‘å¸ƒè®¢é˜….")]),s._v(" "),e("p",[s._v("enï½ok.é«˜èƒ½é¢„è­¦ğŸ¯.æ¥ä¸‹æ¥å°±ç¨ç¨å¤æ‚äº† å› ä¸ºæˆ‘ä»¬è¦å®ç°é“¾å¼è°ƒç”¨thenã€‚ è¦å®ç°è¿™ä¸ªåŠŸèƒ½é‚£æˆ‘ä»¬å°±è¦é‡å†™thenæ–¹æ³•ï¼Œå¹¶åœ¨thenæ–¹æ³•ä¸­é‡æ–°è¿”å›ä¸€ä¸ªPromise,åªæœ‰è¿™æ ·ï¼Œæ‰å¯ä»¥å®ç°å¤šæ¬¡è°ƒç”¨then.è€Œä¸”è¦æ–°å¢ä¸€ä¸ªè§£æè¿”å›å€¼æ˜¯å¦ä¸ºpromiseçš„å‡½æ•°.")]),s._v(" "),e("p",[s._v("ç¨å¾®æ‹ä¸€ä¸‹é€»è¾‘")]),s._v(" "),e("ul",[e("li",[s._v("å¦‚æœä¸€ä¸ªthenæ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªæ™®é€šå€¼çš„è¯ï¼Œè¿™ä¸ªå€¼ä¼šä¼ é€’ç»™ä¸‹ä¸€ä¸ªthenä¸­åšresolveçš„è¿”å›å€¼ï¼›")]),s._v(" "),e("li",[s._v("å¦‚æœthenæ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªpromiseçš„è¯ï¼Œæˆ‘ä»¬è¦æ ¹æ®ä¸Šä¸€ä¸ªthençš„çŠ¶æ€ï¼ˆæˆåŠŸä¸å¤±è´¥ï¼‰æ¥å†³å®šä¸‹ä¸€ä¸ªthençš„æˆåŠŸä¸å¤±è´¥")])]),s._v(" "),e("h2",{attrs:{id:"å¢åŠ é“¾å¼è°ƒç”¨then"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#å¢åŠ é“¾å¼è°ƒç”¨then","aria-hidden":"true"}},[s._v("#")]),s._v(" å¢åŠ é“¾å¼è°ƒç”¨then")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("function Promise(executor) {\n    let that = this;\n    that.status = 'pending';\n    that.value = null;\n    that.reason = null;\n    that.onFilFulledCallbacks = [];\n    that.onRejectedCallbacks = [];\n   \n    function resolve(value) {\n        if (that.status === 'pending') {\n            that.status = 'resolved';\n            that.value = value;\n            that.onFilFulledCallbacks.forEach((fn) = & gt; {\n                fn();\n            });\n        }\n    }\n\n    function reject(reason) {\n        if (that.status === 'pending') {\n            that.status = 'rejected';\n            that.reason = reason;\n            that.onRejectedCallbacks.forEach((fn) = & gt; {\n                fn();\n            });\n        }\n    }\n    executor(resolve, reject);\n}\n\nPromise.prototype.then = function (onFilfulled, onRejected) {\n    let that = this;\n    /** 1 è®©promise2ç­‰äºä¸€ä¸ªæ–°çš„Promise å¹¶å°†promise2è¿”å› */\n    let promise2 = new Promise((resolve, reject) = & gt; {\n        if (that.status === 'resolved') {\n            /** 2 å› ä¸ºè¿”å›äº†promise2 \n             *  å¹¶ä¸”ç¬¬3æ­¥resolvePromiseRelationå‡½æ•°ä¸­ä¼ é€’äº†promise2\n             *  è€Œç›®å‰promise2å¹¶æ²¡æœ‰æ‹¿åˆ°\n             *  æ‰€ä»¥åŠ ä¸€ä¸ªå®šæ—¶å™¨ å¼‚æ­¥æ‰§è¡Œ ç­‰åˆ°promise2æ‹¿åˆ°å \n             *  å†å»æ‰§è¡Œ resolvePromiseRelation()æ–¹æ³• å¹¶å°†promise2ä¼ é€’è¿›å»*/\n            setTimeout(() = & gt; {\n                try {\n                    let promise3 = onFilfulled(that.value);\n                    /** 3 åˆ¤æ–­æ–°è¿”å›å€¼æ˜¯ä»€ä¹ˆç±»å‹çš„å‡½æ•°\n                     *  å¹¶å°†å½“å‰çš„promiseï¼špromise2  æ–°çš„è¿”å›å€¼ï¼špromise3 \n                     *  å’Œ æˆåŠŸæ—¶å›è°ƒï¼šesolve  å¤±è´¥æ—¶å›è°ƒï¼šreject ä½œä¸ºå‚æ•°ä¼ è¿›å» */\n                    resolvePromiseRelation(promise2, promise3, resolve, reject);\n                } catch (e) {\n                    reject(e);\n                }\n            }, 0);\n        }\n        if (that.status === 'rejected') {\n            /** åŒ2 */\n            setTimeout(() = & gt; {\n                try {\n                    let promise3 = onRejected(that.reason);\n                    /** åŒ3*/\n                    resolvePromiseRelation(promise2, promise3, resolve, reject);\n                } catch (e) {\n                    reject(e);\n                }\n            }, 0);\n        }\n        if (that.status === 'pending') {\n            that.onFilFulledCallbacks.push(function () {\n                /** åŒ2 */\n                setTimeout(() = & gt; {\n                    try {\n                        let promise3 = onFilfulled(that.value);\n                        /** åŒ3*/\n                        resolvePromiseRelation(promise2, promise3, resolve, reject);\n                    } catch (e) {\n                        reject(e);\n                    }\n                }, 0);\n            });\n        }\n        if (that.status === 'pending') {\n            that.onRejectedCallbacks.push(function () {\n                /** åŒ2 */\n                setTimeout(() = & gt; {\n                    try {\n                        let promise3 = onRejected(that.reason);\n                        /** åŒ3*/\n                        resolvePromiseRelation(promise2, promise3, resolve, reject);\n                    } catch (e) {\n                        reject(e);\n                    }\n                }, 0);\n            });\n        }\n    });\n    /** åŒ1 */\n    return promise2;\n}\n\nfunction resolvePromiseRelation(promise2, promise3, resolve, reject) {\n    /** 4 é˜²æ­¢è‡ªå·±ç­‰å¾…è‡ªå·± ä¸€ç›´å¾ªç¯ç­‰å¾… */\n    if (promise2 === promise3) {\n        return reject(new TypeError('å¾ªç¯å¼•ç”¨äº†!'));\n    }\n    /**  8 ä¸€ä¸ªæ ‡ç¤º è¡¨ç¤ºå½“å‰æ²¡æœ‰è¢«è°ƒç”¨è¿‡ \n     *   ç¡®ä¿resolveæˆ–è€…rejectåçš„çŠ¶æ€ä¸ä¼šå†æ¬¡å‘ç”Ÿå˜æ›´\n     */\n    let called;\n    /** 5 ä¿è¯promise3æ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹\n     *  åˆ¤æ–­æ–°è¿”å›å€¼promise3çš„ç±»å‹ \n     *  å¦‚æœæ˜¯æ™®é€šå€¼å¸¸é‡ å°±ç›´æ¥resolveå¯¼å‡º */\n    if (promise3 !== null & amp; & amp;\n        (typeof promise3 === 'object' || typeof promise3 === 'function')) {\n        try {\n            let then = promise3.then;\n            /** 6 ç¡®ä¿promise3æ˜¯ä¸€ä¸ªPromise\n             *  åˆ¤æ–­promise3çš„thenæ–¹æ³•\n             *  å¦‚æœå­˜åœ¨ å¹¶ä¸”æ˜¯ä¸€ä¸ªfunctionç±»å‹ \n             *  å°±è¡¨ç¤ºpromise3æ˜¯ä¸€ä¸ªPromise */\n            if (typeof then === 'function') {\n                /** 9 æ‰§è¡Œpromise3çš„thenæ–¹æ³•\n                 *  å› ä¸ºpromise3ä¹Ÿæ˜¯ä¸€ä¸ªPromise\n                 *  éœ€è¦å†æ¬¡è§£æpromise3çš„thenæ–¹æ³•\n                 *  ç›´åˆ°è§£æåˆ°æœ€åçš„è¿”å›å€¼ä¸æ˜¯ä¸€ä¸ªPromiseç±»å‹ä¸ºæ­¢\n                 */\n                then(promise3, (promise4) = & gt; {\n                    /** åŒ8 */\n                    if (called) return;\n                    called = true;\n                    /** 10 é€’å½’è§£ææ–°çš„è¿”å›å€¼çš„ç±»å‹\n                     *  è§£æåˆ°è¿”å›å€¼ä¸æ˜¯ä¸€ä¸ªPromiseç±»å‹ä¸ºæ­¢\n                     */\n                    resolvePromiseRelation(promise3, promise4, resolve, reject);\n                }, (r) = & gt; {\n                    /** åŒ8 */\n                    if (called) return;\n                    called = true;\n                    reject(r);\n                });\n            } else {\n                /** 7 æ­¤æ—¶promise3æ˜¯ä¸€ä¸ªæ™®é€šå¯¹è±¡ ç›´æ¥resolve() */\n                resolve(promise3);\n            }\n        } catch (e) {\n            /** åŒ8 */\n            if (called) return;\n            called = true;\n            reject(e);\n        };\n    } else {\n        //å¸¸é‡\n        /** åŒ5 æ™®é€šå€¼ç›´æ¥resolve()*/\n        resolve(promise3);\n    }\n}\n\nmodule.exports = Promise;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br"),e("span",{staticClass:"line-number"},[s._v("77")]),e("br"),e("span",{staticClass:"line-number"},[s._v("78")]),e("br"),e("span",{staticClass:"line-number"},[s._v("79")]),e("br"),e("span",{staticClass:"line-number"},[s._v("80")]),e("br"),e("span",{staticClass:"line-number"},[s._v("81")]),e("br"),e("span",{staticClass:"line-number"},[s._v("82")]),e("br"),e("span",{staticClass:"line-number"},[s._v("83")]),e("br"),e("span",{staticClass:"line-number"},[s._v("84")]),e("br"),e("span",{staticClass:"line-number"},[s._v("85")]),e("br"),e("span",{staticClass:"line-number"},[s._v("86")]),e("br"),e("span",{staticClass:"line-number"},[s._v("87")]),e("br"),e("span",{staticClass:"line-number"},[s._v("88")]),e("br"),e("span",{staticClass:"line-number"},[s._v("89")]),e("br"),e("span",{staticClass:"line-number"},[s._v("90")]),e("br"),e("span",{staticClass:"line-number"},[s._v("91")]),e("br"),e("span",{staticClass:"line-number"},[s._v("92")]),e("br"),e("span",{staticClass:"line-number"},[s._v("93")]),e("br"),e("span",{staticClass:"line-number"},[s._v("94")]),e("br"),e("span",{staticClass:"line-number"},[s._v("95")]),e("br"),e("span",{staticClass:"line-number"},[s._v("96")]),e("br"),e("span",{staticClass:"line-number"},[s._v("97")]),e("br"),e("span",{staticClass:"line-number"},[s._v("98")]),e("br"),e("span",{staticClass:"line-number"},[s._v("99")]),e("br"),e("span",{staticClass:"line-number"},[s._v("100")]),e("br"),e("span",{staticClass:"line-number"},[s._v("101")]),e("br"),e("span",{staticClass:"line-number"},[s._v("102")]),e("br"),e("span",{staticClass:"line-number"},[s._v("103")]),e("br"),e("span",{staticClass:"line-number"},[s._v("104")]),e("br"),e("span",{staticClass:"line-number"},[s._v("105")]),e("br"),e("span",{staticClass:"line-number"},[s._v("106")]),e("br"),e("span",{staticClass:"line-number"},[s._v("107")]),e("br"),e("span",{staticClass:"line-number"},[s._v("108")]),e("br"),e("span",{staticClass:"line-number"},[s._v("109")]),e("br"),e("span",{staticClass:"line-number"},[s._v("110")]),e("br"),e("span",{staticClass:"line-number"},[s._v("111")]),e("br"),e("span",{staticClass:"line-number"},[s._v("112")]),e("br"),e("span",{staticClass:"line-number"},[s._v("113")]),e("br"),e("span",{staticClass:"line-number"},[s._v("114")]),e("br"),e("span",{staticClass:"line-number"},[s._v("115")]),e("br"),e("span",{staticClass:"line-number"},[s._v("116")]),e("br"),e("span",{staticClass:"line-number"},[s._v("117")]),e("br"),e("span",{staticClass:"line-number"},[s._v("118")]),e("br"),e("span",{staticClass:"line-number"},[s._v("119")]),e("br"),e("span",{staticClass:"line-number"},[s._v("120")]),e("br"),e("span",{staticClass:"line-number"},[s._v("121")]),e("br"),e("span",{staticClass:"line-number"},[s._v("122")]),e("br"),e("span",{staticClass:"line-number"},[s._v("123")]),e("br"),e("span",{staticClass:"line-number"},[s._v("124")]),e("br"),e("span",{staticClass:"line-number"},[s._v("125")]),e("br"),e("span",{staticClass:"line-number"},[s._v("126")]),e("br"),e("span",{staticClass:"line-number"},[s._v("127")]),e("br"),e("span",{staticClass:"line-number"},[s._v("128")]),e("br"),e("span",{staticClass:"line-number"},[s._v("129")]),e("br"),e("span",{staticClass:"line-number"},[s._v("130")]),e("br"),e("span",{staticClass:"line-number"},[s._v("131")]),e("br"),e("span",{staticClass:"line-number"},[s._v("132")]),e("br"),e("span",{staticClass:"line-number"},[s._v("133")]),e("br"),e("span",{staticClass:"line-number"},[s._v("134")]),e("br"),e("span",{staticClass:"line-number"},[s._v("135")]),e("br"),e("span",{staticClass:"line-number"},[s._v("136")]),e("br"),e("span",{staticClass:"line-number"},[s._v("137")]),e("br"),e("span",{staticClass:"line-number"},[s._v("138")]),e("br"),e("span",{staticClass:"line-number"},[s._v("139")]),e("br"),e("span",{staticClass:"line-number"},[s._v("140")]),e("br"),e("span",{staticClass:"line-number"},[s._v("141")]),e("br"),e("span",{staticClass:"line-number"},[s._v("142")]),e("br"),e("span",{staticClass:"line-number"},[s._v("143")]),e("br"),e("span",{staticClass:"line-number"},[s._v("144")]),e("br"),e("span",{staticClass:"line-number"},[s._v("145")]),e("br"),e("span",{staticClass:"line-number"},[s._v("146")]),e("br"),e("span",{staticClass:"line-number"},[s._v("147")]),e("br"),e("span",{staticClass:"line-number"},[s._v("148")]),e("br"),e("span",{staticClass:"line-number"},[s._v("149")]),e("br"),e("span",{staticClass:"line-number"},[s._v("150")]),e("br"),e("span",{staticClass:"line-number"},[s._v("151")]),e("br"),e("span",{staticClass:"line-number"},[s._v("152")]),e("br"),e("span",{staticClass:"line-number"},[s._v("153")]),e("br"),e("span",{staticClass:"line-number"},[s._v("154")]),e("br"),e("span",{staticClass:"line-number"},[s._v("155")]),e("br")])]),e("p",[s._v("ok. è‡³æ­¤ æˆ‘ä»¬å·²ç»å®ç°äº†Promsieçš„å¼‚æ­¥å’Œé“¾å¼è°ƒç”¨. Promiseä¸­æ¯”è¾ƒå¤æ‚çš„éƒ¨åˆ†æˆ‘ä»¬å·²ç»æå®šäº† æ¥ä¸‹æ¥å°±æ˜¯æ·»åŠ ä¸€äº›æ–¹æ³•ï¼Œå…¶å®è¿™éƒ¨åˆ†åè€Œæ²¡é‚£ä¹ˆå¤æ‚äº†.")]),s._v(" "),e("h2",{attrs:{id:"catch-finallyæ–¹æ³•å¢åŠ "}},[e("a",{staticClass:"header-anchor",attrs:{href:"#catch-finallyæ–¹æ³•å¢åŠ ","aria-hidden":"true"}},[s._v("#")]),s._v(" catch|finallyæ–¹æ³•å¢åŠ ")]),s._v(" "),e("ul",[e("li",[s._v("catch : catchæ–¹æ³•æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªthenæ–¹æ³•çš„å˜å½¢ï¼Œåªæœ‰å¤±è´¥æ—¶çš„å›è°ƒ æ²¡æœ‰æˆåŠŸæ—¶çš„å›è°ƒ")]),s._v(" "),e("li",[s._v("catch : finallyæ–¹æ³•çš„ä½œç”¨æ˜¯ä¸ç®¡ Promise å¯¹è±¡æœ€åçŠ¶æ€å¦‚ä½•ï¼Œéƒ½ä¼šæ‰§è¡Œæ“ä½œ.å…¶å®è¯´ç™½äº†å°±æ˜¯åœ¨thenæ–¹æ³•çš„æˆåŠŸå’Œå¤±è´¥çš„å›è°ƒå‡½æ•°ä¸­éƒ½æ‰§è¡Œè¯¥æ–¹æ³•å°±è¡Œäº†.")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("\n/** 1 ç›´æ¥è¿”å›thisçš„thenæ–¹æ³•\n *  å› ä¸ºcatchåªæ•è·é”™è¯¯ æ‰€ä»¥resolveç›´æ¥ä¸ºnull\n *  è¿”å›rejectå°±å¥½*/\nPromise.prototype.catch = function(errFn){\n    return this.then(null,errFn);\n}\n\n/** 3 finallyå®ç°èµ·æ¥ä¹Ÿå¾ˆç®€å• \n *  åˆ†åˆ«åœ¨resolveå’Œrejectä¸­æ‰§è¡Œfnå°±å¥½ \n *  æœ€åå†æŠŠthisè¿”å›å‡ºå»å°±å¥½\n*/\nPromise.prototype.finally = function(fn){\n    this.then(()=&gt;{\n        fn();\n    },()=&gt;{\n        fn();\n    });\n    return this;\n}\n\nmodule.exports = Promise;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br")])]),e("h2",{attrs:{id:"all-race-resolve-rejectç­‰æ–¹æ³•"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#all-race-resolve-rejectç­‰æ–¹æ³•","aria-hidden":"true"}},[s._v("#")]),s._v(" all race resolve rejectç­‰æ–¹æ³•")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("//ç±»æ–¹æ³•ï¼Œå¤šä¸ª Promise ä»»åŠ¡åŒæ—¶æ‰§è¡Œã€‚\n//å¦‚æœå…¨éƒ¨æˆåŠŸæ‰§è¡Œï¼Œåˆ™ä»¥æ•°ç»„çš„æ–¹å¼è¿”å›æ‰€æœ‰ Promise ä»»åŠ¡çš„æ‰§è¡Œç»“æœã€‚ å¦‚æœæœ‰ä¸€ä¸ª Promise ä»»åŠ¡ rejectedï¼Œåˆ™åªè¿”å› rejected ä»»åŠ¡çš„ç»“æœã€‚\n\n/** 1 ç›´æ¥åœ¨æ„é€ å‡½æ•°ä¸Šå¢åŠ allæ–¹æ³•\n *  å®ƒè¿”å›çš„ä¹Ÿæ˜¯ä¸€ä¸ªPromise\n *  ç­‰å¾…å‚æ•°æ•°ç»„ä¸­æ‰€æœ‰çš„promiseéƒ½æ‰§è¡Œå®Œæ¯•å\n *  å†è¿”å›ç»“æœ\n */\nPromise.all = function(values){\n    return new Promise((resolve,reject)=&gt;{\n        /** 2 å®šä¹‰ä¸€ä¸ªå­˜æ”¾æœ€ç»ˆç»“æœçš„æ•°ç»„resultå’Œä¸€ä¸ªindex */ \n        let results = [];\n        let index = 0;\n        /** 3 å®šä¹‰ä¸€ä¸ªæ–¹æ³•addToArr()  \n         *  è®©indexæ¯æ¬¡æ‰§è¡Œå¢åŠ resultsæ•°ç»„å…ƒç´ çš„å‡½æ•°çš„æ—¶å€™éƒ½+1\n         *  å½“index === valuesçš„é•¿åº¦çš„æ—¶å€™ è¯´æ˜æ­¤æ—¶æ‰€æœ‰promsieéƒ½æ‰§è¡Œå®Œæ¯•å¹¶æ”¾åˆ°çš„æ•°ç»„ä¸­\n         *  ç„¶åç›´æ¥resolve(results)å°±è¡Œäº†\n        */\n        function addToArr(key,value){\n            index++;\n            results[key] = value;\n            /** 6 å½“æ»¡è¶³æ¡ä»¶æ—¶ è¯´æ˜æ‰€æœ‰çš„promiseéƒ½æ‰§è¡Œå®Œæ¯• ç›´æ¥resolve(results) */\n            if(index === values.length){\n                resolve(results);\n            }\n        }\n        /** 4 å¾ªç¯valuesä¸­çš„æ¯ä¸€é¡¹promsie */\n        for(let i = 0; i &lt; values.length; i++){\n            let current = values[i];\n            /** 5 åˆ¤æ–­æ¯ä¸€é¡¹promiseçš„è¿”å›å€¼æ˜¯ä¸æ˜¯ä¸€ä¸ªPromsie\n             *  æ˜¯çš„è¯å°±æ‰§è¡Œè¯¥Promiseçš„thenæ–¹æ³• æ‹¿åˆ°è¿”å›å€¼ å¹¶æ”¾åˆ°æ•°ç»„resultsä¸­\n             *  æ˜¯ä¸€ä¸ªæ™®é€šå€¼çš„è¯å°±ç›´æ¥å°†è¯¥å€¼æ”¾åˆ°æ•°ç»„resultsä¸­\n             */\n            if(current &amp;&amp; current.then &amp;&amp; typeof current.then === 'function'){\n                current.then((value)=&gt;{\n                    /** åŒ5 æŠŠè¿”å›å€¼æ”¾åˆ°æ•°ç»„resultsä¸­*/\n                    addToArr(i,value);\n                },reject);\n            }else{\n                /** åŒ5 æŠŠè¿”å›å€¼æ”¾åˆ°æ•°ç»„resultsä¸­*/\n                addToArr(i,current);\n            }\n        }\n    });\n}\n\n//ç±»æ–¹æ³•ï¼Œå¤šä¸ª Promise ä»»åŠ¡åŒæ—¶æ‰§è¡Œï¼Œè¿”å›æœ€å…ˆæ‰§è¡Œç»“æŸçš„ Promise ä»»åŠ¡çš„ç»“æœï¼Œä¸ç®¡è¿™ä¸ª Promise ç»“æœæ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ã€‚ \nã€‚\n/** raceæ–¹æ³•ç›¸æ¯”è¾ƒäºallæ–¹æ³•ç®€å•å¾ˆå¤š\n *  å› ä¸ºraceä¸­çš„promsieæˆåŠŸresolveä¸€ä¸ª \n *  æ•´ä¸ªraceå°±resolve */\nPromise.race = function(values){\n    return new Promise((resolve,reject)=&gt;{\n        /** åŒ4 */\n        for(let i = 0; i &lt; values.length; i++){\n            let current = values[i];\n            /** åŒ5 */\n            if(current&amp;&amp;current.then&amp;&amp;typeof current.then === 'function'){\n                /** 7 ç›´æ¥æ‰§è¡Œthenå°±å¥½ */\n                current.then(resolve,reject);\n            }else{\n                /** 8 æ™®é€šå€¼ç›´æ¥resolve */\n                resolve(current);\n            }\n        }\n    });\n}\n\n\n// resolveæ–¹æ³•\nPromise.resolve = function(value){\n    return new Promise((resolve,reject)=&gt;{\n        resolve(value);\n    });\n}\n// rejectæ–¹æ³•\nPromise.reject = function(reason){\n    return new Promise((resolve,reject)=&gt;{\n        reject(reason);\n    });\n}\n\nmodule.exports = Promise;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br"),e("span",{staticClass:"line-number"},[s._v("77")]),e("br"),e("span",{staticClass:"line-number"},[s._v("78")]),e("br"),e("span",{staticClass:"line-number"},[s._v("79")]),e("br"),e("span",{staticClass:"line-number"},[s._v("80")]),e("br"),e("span",{staticClass:"line-number"},[s._v("81")]),e("br"),e("span",{staticClass:"line-number"},[s._v("82")]),e("br"),e("span",{staticClass:"line-number"},[s._v("83")]),e("br")])]),e("h2",{attrs:{id:"å®ç°ä¸€ä¸ªpromiseçš„å»¶è¿Ÿå¯¹è±¡defer"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#å®ç°ä¸€ä¸ªpromiseçš„å»¶è¿Ÿå¯¹è±¡defer","aria-hidden":"true"}},[s._v("#")]),s._v(" å®ç°ä¸€ä¸ªpromiseçš„å»¶è¿Ÿå¯¹è±¡defer")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("// å®ç°ä¸€ä¸ªpromiseçš„å»¶è¿Ÿå¯¹è±¡ defer\nPromise.defer = Promise.deferred = function(){\n    let dfd = {};\n    dfd.promise = new Promise((resolve, reject)=&gt;{\n        dfd.resolve = resolve;\n        dfd.reject = reject;\n    });\n    return dfd;\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h2",{attrs:{id:"æœ€ç»ˆæµ‹è¯•"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#æœ€ç»ˆæµ‹è¯•","aria-hidden":"true"}},[s._v("#")]),s._v(" æœ€ç»ˆæµ‹è¯•")]),s._v(" "),e("ul",[e("li",[s._v("æµ‹è¯•å½“å‰ä»£ç æ˜¯å¦ç¬¦åˆPromise/A+è§„èŒƒ")]),s._v(" "),e("li",[s._v("å…¨å±€å®‰è£… npm i -g promises-aplus-tests")]),s._v(" "),e("li",[s._v("æ–‡ä»¶æ‰€åœ¨ç›®å½•è¿è¡Œä»¥ä¸‹å‘½ä»¤ (ä¾‹å¦‚ä½ çš„æ–‡ä»¶åä¸º:MyPrommise.js)")]),s._v(" "),e("li",[s._v("promise-aplus-tests MyPrommise.js")]),s._v(" "),e("li",[s._v("ç­‰å¾…")]),s._v(" "),e("li",[s._v("ok.")])])])},[],!1,null,null,null);n.default=t.exports}}]);