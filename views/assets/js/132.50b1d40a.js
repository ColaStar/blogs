(window.webpackJsonp=window.webpackJsonp||[]).push([[132],{169:function(s,a,e){"use strict";e.r(a);var n=e(0),t=Object(n.a)({},function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"重构-改善既有代码的设计"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#重构-改善既有代码的设计","aria-hidden":"true"}},[s._v("#")]),s._v(" 重构 - 改善既有代码的设计")]),s._v(" "),e("h2",{attrs:{id:"_1-重构，第一个示例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-重构，第一个示例","aria-hidden":"true"}},[s._v("#")]),s._v(" 1 重构，第一个示例")]),s._v(" "),e("ul",[e("li",[s._v("重构前，先检查自己是否有一套可靠的测试集。这些测试必须有自我验证能力。TDD")]),s._v(" "),e("li",[s._v("重构技术就是以微小的步伐修改程序。如果犯下错误，很容易便可发现它。")]),s._v(" "),e("li",[s._v("傻瓜都能写出计算机可以理解的代码。唯有能写出人类容易理解的代码的，才是优秀的程序员。")]),s._v(" "),e("li",[s._v("编程时，需要遵循营地法则：保证你离开时，代码库一定比来的时候更健康。")]),s._v(" "),e("li",[s._v("好代码验证的标准是人们是否能轻而易举的修改它。")])]),s._v(" "),e("h2",{attrs:{id:"_2-重构的原则"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-重构的原则","aria-hidden":"true"}},[s._v("#")]),s._v(" 2 重构的原则")]),s._v(" "),e("h3",{attrs:{id:"_2-1-何谓重构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-何谓重构","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.1 何谓重构")]),s._v(" "),e("ul",[e("li",[s._v("重构：对软件内部结构的一种调整，目的是在"),e("em",[s._v("不改变可观察行为的前提下")]),s._v("，提高其可理解性，降低其修改成本。")]),s._v(" "),e("li",[s._v("重构的关键在于运用大量小且保证软件行为的步骤，一步步达到大规模的修改。")]),s._v(" "),e("li",[s._v("如果有人说他们的代码在重构过程中有1-2天时间不可用，基本上可以确定，他们在做的事不是重构。")])]),s._v(" "),e("h2",{attrs:{id:"_2-2-两顶帽子"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-两顶帽子","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.2 两顶帽子")]),s._v(" "),e("ul",[e("li",[s._v("添加新功能，可能需要优化之前的程序结构；当功能开发好，也需要优化下程序的结构。不同的角色切换，是在添加功能过程中必不可少的步骤。")])]),s._v(" "),e("h3",{attrs:{id:"_2-3-为何重构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-为何重构","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.3 为何重构")]),s._v(" "),e("ul",[e("li",[s._v("改进软件的设计")]),s._v(" "),e("li",[s._v("使软件更容易理解")]),s._v(" "),e("li",[s._v("帮助开发者找到bug")]),s._v(" "),e("li",[s._v("提高编程速度")])]),s._v(" "),e("h3",{attrs:{id:"_2-4-何时重构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-何时重构","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.4 何时重构")]),s._v(" "),e("ul",[e("li",[s._v("预备性：让添加新功能更容易")]),s._v(" "),e("li",[s._v("帮助理解：使代码更易懂")]),s._v(" "),e("li",[s._v("捡垃圾式重构")]),s._v(" "),e("li",[s._v("有计划和见机行事的重构：肮脏的代码必须重构，但漂亮的代码也需要很多重构")]),s._v(" "),e("li",[s._v("长期重构")]),s._v(" "),e("li",[s._v("复审代码时重构")]),s._v(" "),e("li",[s._v("何时不应该重构：\n"),e("ul",[e("li",[s._v("只有当需要理解其工作原理时")]),s._v(" "),e("li",[s._v("如果重写比重构容易。")])])])]),s._v(" "),e("h3",{attrs:{id:"_2-5-重构的挑战"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-重构的挑战","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.5 重构的挑战")]),s._v(" "),e("ul",[e("li",[s._v("缓解新功能开发\n"),e("ul",[e("li",[s._v("重构的唯一目的就是让我们开发更快，用更少的工作量创造更大的价值")]),s._v(" "),e("li",[s._v("重构应该总是由经济利益驱动，而不是在于把代码库打磨得闪闪发光")])])])]),s._v(" "),e("h2",{attrs:{id:"_10-简化条件逻辑"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_10-简化条件逻辑","aria-hidden":"true"}},[s._v("#")]),s._v(" 10 简化条件逻辑")]),s._v(" "),e("h1",{attrs:{id:"_10-1-分解条件表达式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_10-1-分解条件表达式","aria-hidden":"true"}},[s._v("#")]),s._v(" 10.1 分解条件表达式")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("目的：简化条件，易于理解代码逻辑")])]),s._v(" "),e("li",[e("p",[s._v("场景：当检查处理逻辑复杂时")])]),s._v(" "),e("li",[e("p",[s._v("例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("if(!date.isBefore(plan.summerStart) && !date.isAfter(plan.summerEnd)){\n\tcharge = quanlity * plan.summerRate;\n}else{\n\tcharge = quanlity * plan.regularRate + plan.regularServiceCharge;\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("const isSummer = !date.isBefore(plan.summerStart) && !date.isAfter(plan.summerEnd);\nfunction summerCharge(){\n\treturn quanlity * plan.summerRate;\n}\nfunction regularCharge(){\n\treturn quanlity * plan.regularRate + plan.regularServiceCharge;\n}\n\ncharge = isSummer() ? summerCharge() : regularCharge();\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])])])]),s._v(" "),e("h1",{attrs:{id:"_10-2-合并条件表达式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_10-2-合并条件表达式","aria-hidden":"true"}},[s._v("#")]),s._v(" 10.2 合并条件表达式")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("目的：统一处理条件语句")])]),s._v(" "),e("li",[e("p",[s._v("场景：当检查条件各不相同，最终行为一致时")])]),s._v(" "),e("li",[e("p",[s._v("例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("if(age < 18) return 'younger';\nif(exprience < 5) return 'younger';\nif(!isPassTest) return 'younger';\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("if(isYounger()) return 'younger';\nfunction isYounger(){\n\treturn age<18 || exprience < 5 || !isPassTest\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])])])]),s._v(" "),e("h1",{attrs:{id:"_10-3-卫语句取代嵌套条件表达式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_10-3-卫语句取代嵌套条件表达式","aria-hidden":"true"}},[s._v("#")]),s._v(" 10.3 卫语句取代嵌套条件表达式")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("目的：减少逻辑的复杂度")])]),s._v(" "),e("li",[e("p",[s._v("场景：当出现需要单独检查某个特定条件时")])]),s._v(" "),e("li",[e("p",[s._v("例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("function getPayment(){\n\tlet result;\n\tif(isRead){\n\t\tresult = deadAmount();\n\t}else{\n\t\tif(isSeparated){\n\t\t\tresult = seperatedAmount();\n\t\t}else{\n\t\t\tif(isRetired){\n\t\t\t\tresult = retiredAmount();\n\t\t\t}else{\n\t\t\t\tresult = normalAmount();\n\t\t\t}\n\t\t}\n\t}\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("function getPayment(){\n\tif(isRead) return deadAmount();\n\tif(isSeparated) return seperatedAmount();\n\tif(isRetired) return retiredAmount();\n\t\n\treturn normalAmount();\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])])])]),s._v(" "),e("h1",{attrs:{id:"_10-4-以多态取代条件表达式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_10-4-以多态取代条件表达式","aria-hidden":"true"}},[s._v("#")]),s._v(" 10.4 以多态取代条件表达式")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("目的：增强扩展性，减少逻辑的复杂度")])]),s._v(" "),e("li",[e("p",[s._v("场景：当多个逻辑处理情况")])]),s._v(" "),e("li",[e("p",[s._v("例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("switch(bird.type){\n\tcase 'EuropeanSwallow':\n\t\treturn 'EuropeanSwallow';\n\tcase 'AfricanSwallow':\n\t\treturn 'AfricanSwallow';\n\tdefault:\n\t\treturn 'unknown';\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("class EuropeanSwallow{\n\tget name(){\n\t\treturn 'EuropeanSwallow';\n\t}\n}\nclass AfricanSwallow{\n\tget name(){\n\t\treturn 'AfricanSwallow';\n\t}\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])])])]),s._v(" "),e("h1",{attrs:{id:"_10-5-引入特例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_10-5-引入特例","aria-hidden":"true"}},[s._v("#")]),s._v(" 10.5 引入特例")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("目的：提供复用性以及统一性")])]),s._v(" "),e("li",[e("p",[s._v("场景：如果某部分逻辑都在检查某个特殊值，并且处理的逻辑也都相同")])]),s._v(" "),e("li",[e("p",[s._v("例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("if(customer === 'unknown'){\n\tcustomerName = 'occupant';\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("class UnknowCustomer{\n\tget name(){\n\t\treturn 'occupant';\n\t}\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])])])]),s._v(" "),e("h1",{attrs:{id:"_10-6-引入断言"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_10-6-引入断言","aria-hidden":"true"}},[s._v("#")]),s._v(" 10.6 引入断言")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("目的：保障传入值是可预测的，预习发现测试的BUG")])]),s._v(" "),e("li",[e("p",[s._v("例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("if(this.discountRate){\n\tbase = base - this.discountRate * base;\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("asset(this.discountRate>0);\nif(this.discountRate){\n\tbase = base - this.discountRate * base;\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])])])]),s._v(" "),e("h2",{attrs:{id:"_11-重构api"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_11-重构api","aria-hidden":"true"}},[s._v("#")]),s._v(" 11 重构API")]),s._v(" "),e("h1",{attrs:{id:"_11-1-查询函数和修改函数分离"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_11-1-查询函数和修改函数分离","aria-hidden":"true"}},[s._v("#")]),s._v(" 11.1 查询函数和修改函数分离")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("目的：减少函数副作用 =》任何有返回值的函数，都要减少它的副作用")])]),s._v(" "),e("li",[e("p",[s._v("场景：当函数中又有查询，又有命令")])]),s._v(" "),e("li",[e("p",[s._v("例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("function getTotalOutstadingAndSendBill(person){\n\tconst result = customer.invoice.reduce((total, each)=>each.amount + total, 0);\n\tsendBill();\n\treturn result;\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("function getTotalOutstading(person){\n\treturn customer.invoice.reduce((total, each)=>each.amount + total, 0);\n}\nfunction sendBill(){}\nfunction handler(){\n\tconst totalOutstading = getTotalstading();\n\tsendBilld();\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])])])]),s._v(" "),e("h1",{attrs:{id:"_11-2-函数参数化"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_11-2-函数参数化","aria-hidden":"true"}},[s._v("#")]),s._v(" 11.2 函数参数化")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("目的：增强函数的功能")])]),s._v(" "),e("li",[e("p",[s._v("场景：如果发现多个函数逻辑相似，只有某1-2个字面量不同")])]),s._v(" "),e("li",[e("p",[s._v("例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("function tenPercentRaise(person){\n\tperson.salary = person.salary.multiply(1.1);\n}\nfunction fivePercentRaise(person){\n\tperson.salary = person.salary.multiply(0.05);\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("function raise(person, factor){\n\tperson.salary = person.salary.multiply(factor);\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])])])]),s._v(" "),e("h1",{attrs:{id:"_11-3-移除标记参数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_11-3-移除标记参数","aria-hidden":"true"}},[s._v("#")]),s._v(" 11.3 移除标记参数")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("目的：代码更清晰，减少函数的复杂度")])]),s._v(" "),e("li",[e("p",[s._v("场景：如果参数值影响函数内部的控制流")])]),s._v(" "),e("li",[e("p",[s._v("例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("function setDimension(name, value){\n\tif(name === 'height'){}\n\tif(name === 'width'){}\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("function setHeight(value){\n\tthis._height = value\n}\nfunction setWidth(value){\n\tthis._width = value\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])])])]),s._v(" "),e("h1",{attrs:{id:"_11-4-保持对象完整性"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_11-4-保持对象完整性","aria-hidden":"true"}},[s._v("#")]),s._v(" 11.4 保持对象完整性")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("目的：缩短参数列表，参数配置灵活")])]),s._v(" "),e("li",[e("p",[s._v("场景：如果传入多个参数传值")])]),s._v(" "),e("li",[e("p",[s._v("例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("const{low, high} = temperature;\nif(isValidTemperature(low,high)){};\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("if(isValidTemperature(temperature)){};\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])]),s._v(" "),e("h1",{attrs:{id:"_11-5-以查询取代参数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_11-5-以查询取代参数","aria-hidden":"true"}},[s._v("#")]),s._v(" 11.5 以查询取代参数")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("对立：以参数取代查询")])]),s._v(" "),e("li",[e("p",[s._v("目的：减少传参，从而减少调用者的成本，保持")])]),s._v(" "),e("li",[e("p",[s._v("场景：如果传入多个参数，并且从一个参数推导出另一个参数")])]),s._v(" "),e("li",[e("p",[s._v("例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("availableVacation(employee, employee.grade);\nfunction availableVacation(employee,grade){}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("availableVacation(employee);\nfunction availableVacation(employee){\n\tconst{grade} = employee;\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])])])]),s._v(" "),e("h1",{attrs:{id:"_11-6-以参数取代查询"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_11-6-以参数取代查询","aria-hidden":"true"}},[s._v("#")]),s._v(" 11.6 以参数取代查询")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("对立：以查询取代参数")])]),s._v(" "),e("li",[e("p",[s._v("目的：减少函数的副作用，以及引用关系，保持函数的纯净度")])]),s._v(" "),e("li",[e("p",[s._v("场景：如果函数引用了一个全局变量，或者引用想移除的元素")])]),s._v(" "),e("li",[e("p",[s._v("例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("const weather ={};\ntargetTemperature(plan)\n\nfunction targetTemperature(plan){\n\tconst{curTemperature} = weather;\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("const weather ={};\ntargetTemperature(plan, weather)\n\nfunction targetTemperature(plan, weather){\n\tconst{curTemperature} = weather;\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])])])]),s._v(" "),e("h1",{attrs:{id:"_11-7-移除设置函数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_11-7-移除设置函数","aria-hidden":"true"}},[s._v("#")]),s._v(" 11.7 移除设置函数")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("目的：防止某字段被修改")])]),s._v(" "),e("li",[e("p",[s._v("场景：当不希望某个字段被修改时")])]),s._v(" "),e("li",[e("p",[s._v("例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("class Person{\n\tget id(){}\n\tset id(name){}\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("class Person{\n\tget id(){}\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])])])]),s._v(" "),e("h1",{attrs:{id:"_11-8-以工厂函数取代构造函数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_11-8-以工厂函数取代构造函数","aria-hidden":"true"}},[s._v("#")]),s._v(" 11.8 以工厂函数取代构造函数")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("目的：增加灵活性")])]),s._v(" "),e("li",[e("p",[s._v("场景：不存在继承关系时")])]),s._v(" "),e("li",[e("p",[s._v("例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("const leadEngineer = new Employee('name','E');\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("const leadEngineer = createEngineer('name');\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])]),s._v(" "),e("h1",{attrs:{id:"_11-9-以命令取代函数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_11-9-以命令取代函数","aria-hidden":"true"}},[s._v("#")]),s._v(" 11.9 以命令取代函数")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("对立：以函数取代命令")])]),s._v(" "),e("li",[e("p",[s._v("目的：命令对象提供更大的灵活性，并且还可以支持撤销、生命周期的管理等附加操作")])]),s._v(" "),e("li",[e("p",[s._v("场景：当普通函数无法提供强有力灵活性")])]),s._v(" "),e("li",[e("p",[s._v("例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("function score(candidate, media){\n\tlet result = 0;\n\tlet healthLevel = 0;\n}\nfunction hasPassMedicalExam(){}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("class Scorer{\n\tconstructor(candidate, medicalExam){\n\t\tthis._candidate = candidate;\n\t\tthis._medicalExam = medicalExam;\n\t}\n\texecute(){\n\t\tlet result = 0;\n\t\tlet healthLevel = 0;\n\t}\n\thasPassMedicalExam(){}\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])])])]),s._v(" "),e("h1",{attrs:{id:"_11-10-以函数取代命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_11-10-以函数取代命令","aria-hidden":"true"}},[s._v("#")]),s._v(" 11.10 以函数取代命令")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("对立：以命令取代函数")])]),s._v(" "),e("li",[e("p",[s._v("目的：函数简单化")])]),s._v(" "),e("li",[e("p",[s._v("场景：大多数情况下，只想调用一个函数，完成自己的工作，不需要函数那么复杂")])]),s._v(" "),e("li",[e("p",[s._v("例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("class ChargeCalculator{\n\tconstructor(customer, usage){\n\t\tthis._customer = customer;\n\t\tthis._usage = usage;\n\t}\n\texecute(){ \n\t\treturn this._customer.rate * this._usage;\n\t}\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("function charge(customer, usage){\n\treturn customer.rate * usage;\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])])])]),s._v(" "),e("h2",{attrs:{id:"_12-处理继承关系"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_12-处理继承关系","aria-hidden":"true"}},[s._v("#")]),s._v(" 12 处理继承关系")]),s._v(" "),e("p",[s._v("继承体系里上下调整："),e("a",{attrs:{href:"#121-%E5%87%BD%E6%95%B0%E4%B8%8A%E7%A7%BB"}},[s._v("函数上移")]),s._v("、"),e("a",{attrs:{href:"#122-%E5%AD%97%E6%AE%B5%E4%B8%8A%E7%A7%BB"}},[s._v("字段上移")]),s._v("、"),e("a",{attrs:{href:"#123-%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E6%9C%AC%E4%BD%93%E4%B8%8A%E7%A7%BB"}},[s._v("构造函数本体上移")]),s._v("、"),e("a",{attrs:{href:"#124-%E5%87%BD%E6%95%B0%E4%B8%8B%E7%A7%BB"}},[s._v("函数下移")]),s._v("、"),e("a",{attrs:{href:"#125-%E5%AD%97%E6%AE%B5%E4%B8%8B%E7%A7%BB"}},[s._v("字段下移")])]),s._v(" "),e("p",[s._v("继承体系添加新类或者删除旧类："),e("a",{attrs:{href:"#127-%E7%A7%BB%E9%99%A4%E5%AD%90%E7%B1%BB"}},[s._v("移除子类")]),s._v("、"),e("a",{attrs:{href:"#128-%E6%8F%90%E5%8F%96%E8%B6%85%E7%B1%BB"}},[s._v("提取超类")]),s._v("、"),e("a",{attrs:{href:"#129-%E6%8A%98%E5%8F%A0%E7%BB%A7%E6%89%BF%E4%BD%93%E7%B3%BB"}},[s._v("折叠继承体系")])]),s._v(" "),e("p",[s._v("一个字段仅用于类型码使用："),e("a",{attrs:{href:"#126-%E4%BB%A5%E5%AD%90%E7%B1%BB%E5%8F%96%E4%BB%A3%E7%B1%BB%E5%9E%8B%E7%A0%81"}},[s._v("以子类取代类型码")])]),s._v(" "),e("p",[s._v("如果本来使用集成的场景变得不再适合："),e("a",{attrs:{href:"#1210-%E4%BB%A5%E5%A7%94%E6%89%98%E5%8F%96%E4%BB%A3%E5%AD%90%E7%B1%BB"}},[s._v("以委托取代子类")]),s._v("、"),e("a",{attrs:{href:"#1211-%E4%BB%A5%E5%A7%94%E6%89%98%E5%8F%96%E4%BB%A3%E8%B6%85%E7%B1%BB"}},[s._v("以委托取代超类")])]),s._v(" "),e("h3",{attrs:{id:"_12-1-函数上移"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_12-1-函数上移","aria-hidden":"true"}},[s._v("#")]),s._v(" 12.1 函数上移")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("对立：函数下移")])]),s._v(" "),e("li",[e("p",[s._v("目的：提高复用性，减少重复")])]),s._v(" "),e("li",[e("p",[s._v("场景：当函数被大部分部分子类用到时")])]),s._v(" "),e("li",[e("p",[s._v("例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("class Employee{}\nclass Salesman extends Employee{\n\tget name(){}\n}\nclass Engineer extends Employee{\n\tget name(){}\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("class Employee{\n\tget name(){}\n}\nclass Salesman extends Employee{}\nclass Engineer extends Employee{}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])])])]),s._v(" "),e("h3",{attrs:{id:"_12-2-字段上移"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_12-2-字段上移","aria-hidden":"true"}},[s._v("#")]),s._v(" 12.2 字段上移")]),s._v(" "),e("p",[e("a",{attrs:{href:"#123-%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E6%9C%AC%E4%BD%93%E4%B8%8A%E7%A7%BB"}},[s._v("移构造函数本体上移")])]),s._v(" "),e("h3",{attrs:{id:"_12-3-构造函数本体上移"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_12-3-构造函数本体上移","aria-hidden":"true"}},[s._v("#")]),s._v(" 12.3 构造函数本体上移")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("目的：提高复用性")])]),s._v(" "),e("li",[e("p",[s._v("场景：当多个子类有公共字段")])]),s._v(" "),e("li",[e("p",[s._v("例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("class Party{}\nclass Employee extends Party{\n\tconstructor(id){\n\t\tthis._id = id;\n\t}\n}\nclass Salesman extends Employee{\n\tconstructor(id){\n\t\tthis._id = id;\n\t\tthis._name = name;\n\t}\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("class Party{\n\tconstructor(id){\n\t\tthis._id = id;\n\t}\n}\nclass Employee extends Party{\n\tconstructor(id){\n\t\tsuper(id);\n\t}\n}\nclass Salesman extends Employee{\n\tconstructor(id){\n\t\tsuper(id);\n\t\tthis._name = name;\n\t}\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br")])])])]),s._v(" "),e("h3",{attrs:{id:"_12-4-函数下移"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_12-4-函数下移","aria-hidden":"true"}},[s._v("#")]),s._v(" 12.4 函数下移")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("对立：函数上移")])]),s._v(" "),e("li",[e("p",[s._v("目的：内聚子类的方法")])]),s._v(" "),e("li",[e("p",[s._v("场景：当函数被小部分子类用到时")])]),s._v(" "),e("li",[e("p",[s._v("例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("class Employee{\n\tget quota(){}\n}\nclass Salesman extends Employee{}\nclass Engineer extends Employee{}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("class Employee{}\nclass Salesman extends Employee{\n\tget quota(){}\n}\nclass Engineer extends Employee{}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])])])]),s._v(" "),e("h3",{attrs:{id:"_12-5-字段下移"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_12-5-字段下移","aria-hidden":"true"}},[s._v("#")]),s._v(" 12.5 字段下移")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("对立：字段上移")])]),s._v(" "),e("li",[e("p",[s._v("目的：内聚子类的字段")])]),s._v(" "),e("li",[e("p",[s._v("场景：当字段被小部分子类用到时")])]),s._v(" "),e("li",[e("p",[s._v("例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("class Employee{\n\tconstuctor(quote){\n\t\tthis._quote = quote;\n\t}\n}\nclass Salesman extends Employee{\n\tconstuctor(quote){\n\t\tsuper(quote);\n\t}\n}\nclass Engineer extends Employee{}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("class Employee{}\nclass Salesman extends Employee{\n\tconstuctor(quote){\n\t\tthis._quote = quote;\n\t}\n}\nclass Engineer extends Employee{}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])])])]),s._v(" "),e("h3",{attrs:{id:"_12-6-以子类取代类型码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_12-6-以子类取代类型码","aria-hidden":"true"}},[s._v("#")]),s._v(" 12.6 以子类取代类型码")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("对立：移除子类")])]),s._v(" "),e("li",[e("p",[s._v("目的：更明确地表达数据与类型之间的关系，增强子类的扩展性")])]),s._v(" "),e("li",[e("p",[s._v("场景：当不同的状态码表现不同的行为时")])]),s._v(" "),e("li",[e("p",[s._v("例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("function createEmployee(name, type){\n\treturn new Employee(name, type);\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("function createEmployee(name, type){\n\tconst employeeTypes = (name) =>{\n\t\treturn{\n\t\t\t'engineer': new Engineer(name),\n\t\t\t'salesman': new Salesman(name)\n\t\t}\n\t}\n\treturn employeeTypes(name)[type];\n}\t\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])])])]),s._v(" "),e("h3",{attrs:{id:"_12-7-移除子类"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_12-7-移除子类","aria-hidden":"true"}},[s._v("#")]),s._v(" 12.7 移除子类")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("对立：以子类取代类型码")])]),s._v(" "),e("li",[e("p",[s._v("目的：减少系统复杂度")])]),s._v(" "),e("li",[e("p",[s._v("场景：当子类的用处太少时，当子类简单")])]),s._v(" "),e("li",[e("p",[s._v("例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("class Person{\n\tget genderCode(){\n\t\treturn 'X';\n\t}\n}\nclass Male extends Person{\n\tget genderCode(){\n\t\treturn 'M';\n\t}\n}\nclass Female extends Person {\n\tget genderCode(){\n\t\treturn 'F';\n\t}\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("class Person{\n\tconstructor(genderCode){\n\t\tthis._genderCode = genderCode;\n\t}\n\tget genderCode(){\n\t\treturn this._genderCode;\n\t}\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])])])]),s._v(" "),e("h3",{attrs:{id:"_12-8-提取超类"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_12-8-提取超类","aria-hidden":"true"}},[s._v("#")]),s._v(" 12.8 提取超类")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("目的：把重复的行为收拢起来")])]),s._v(" "),e("li",[e("p",[s._v("场景：当多个子类的方法基本一致时")])]),s._v(" "),e("li",[e("p",[s._v("例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("class Department{\n\tget totalAnnualCost(){}\n\tget name(){}\n}\nclass Employee{\n\tget annualCost(){}\n\tget name(){}\n\tget id(){}\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("class Party{\n\tget totalAnnualCost(){}\n\tget name(){}\n}\nclass Department extends Party{\n\tget primaryCost(){}\n}\nclass Employee extends Party{\n\tget id(){}\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])])])]),s._v(" "),e("h3",{attrs:{id:"_12-9-折叠继承体系"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_12-9-折叠继承体系","aria-hidden":"true"}},[s._v("#")]),s._v(" 12.9 折叠继承体系")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("目的：合并子类，减少不必要的子类，降低系统复杂度")])]),s._v(" "),e("li",[e("p",[s._v("场景：当超类与子类没有多大差别")])]),s._v(" "),e("li",[e("p",[s._v("例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("class Employee{}\nclass Sales extends Employee{}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("div",{staticClass:"language-transfer line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("class Employee{}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])]),s._v(" "),e("h3",{attrs:{id:"_12-10-以委托取代子类"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_12-10-以委托取代子类","aria-hidden":"true"}},[s._v("#")]),s._v(" 12.10 以委托取代子类")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("目的：增强类的扩展性")])]),s._v(" "),e("li",[e("p",[s._v("场景：当子类可能存在多种类型上的变化")])]),s._v(" "),e("li",[e("p",[s._v("例子")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("class Booking{\n\tconstuctor(show, date){\n\t\tthis._show = show;\n\t\tthis._date = date;\n\t}\n}\n\nclass PremiumBooking extends Booking{\n\tconstructor(show, date, extras){\n\t\tsuper(show, date);\n\t\tthis._extras = extras;\n\t}\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("div",{staticClass:"language-transfer line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("class Booking{\n\tconstuctor(show, date){\n\t\tthis._show = show;\n\t\tthis._date = date;\n\t\tthis._premium = null;\n\t}\n\tbePremium(extras){\n\t\tthis._premium = new PremiumBookingDelegate(this, extras);\n\t}\n}\n\nclass PremiumBookingDelegate{\n\tconstructor(root, extras){\n\t\tthis._root = root;\n\t\tthis._extras = extras;\n\t}\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br")])])])]),s._v(" "),e("h3",{attrs:{id:"_12-11-以委托取代超类"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_12-11-以委托取代超类","aria-hidden":"true"}},[s._v("#")]),s._v(" 12.11 以委托取代超类")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("目的：增强类的扩展性")])]),s._v(" "),e("li",[e("p",[s._v("场景：当超类的部分方法不适用于子类，不清晰的继承关系")])]),s._v(" "),e("li",[e("p",[s._v("例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("class List{}\nclass Stack extends List{}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("div",{staticClass:"language-transfer line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("class List{}\nclass Stack{\n\tconstructor(){\n\t\tthis._list = new List();\n\t}\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])])])]),s._v(" "),e("blockquote",[e("p",[s._v("超类的所有方法都适用于子类，子类的所有实例都是超类的实例 => 使用继承尽量使用继承")])]),s._v(" "),e("blockquote",[e("p",[s._v("如果发现继承有问题（扩展困难），再使用"),e("a",{attrs:{href:"#1211-%E4%BB%A5%E5%A7%94%E6%89%98%E5%8F%96%E4%BB%A3%E8%B6%85%E7%B1%BB"}},[s._v("以委托取代超类")])])])])},[],!1,null,null,null);a.default=t.exports}}]);